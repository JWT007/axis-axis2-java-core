<service name="SecureService">

	<module ref="rahas"/>

	<parameter locked="false" name="ServiceClass">org.apache.axis2.security.rahas.Service</parameter>

	<operation name="echo">
		<messageReceiver class="org.apache.axis2.receivers.RawXMLINOutMessageReceiver"/>
		<actionMapping>urn:echo</actionMapping>
	</operation>    

    <parameter name="sct-issuer-config">
		<sct-issuer-config>
			<proofToken>EncryptedKey</proofToken>
			<cryptoProperties>sctIssuer.properties</cryptoProperties>
			<addRequestedAttachedRef />
		</sct-issuer-config>
    </parameter>
    
    <parameter xmlns="" name="rahas-configuration">
		<rahas-configuration xmlns="">
			<scope xmlns="">service</scope>
			<passwordCallbackClass xmlns="">org.apache.axis2.security.rahas.PWCallback</passwordCallbackClass>
			<cryptoProperties xmlns="">sctIssuer.properties</cryptoProperties>
		</rahas-configuration>
    </parameter>

    <parameter name="InflowSecurity">
      <action>
        <items>Timestamp Signature</items>
        <signaturePropFile>sctIssuer.properties</signaturePropFile>
      </action>
    </parameter>

    <parameter name="OutflowSecurity">
      <action>
        <items>Timestamp Signature Encrypt</items>
        <encryptionUser>useReqSigCert</encryptionUser>
        <user>sts</user>
        <signaturePropFile xmlns="">sctIssuer.properties</signaturePropFile>
	<passwordCallbackClass xmlns="">org.apache.axis2.security.rahas.PWCallback</passwordCallbackClass>
      </action>
    </parameter>
    
</service>
